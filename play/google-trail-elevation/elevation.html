<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <style>

      body,
      svg {
        margin: 0;
        padding: 0;
      }

      path.elevation {
        fill: none;
        stroke: #000;
        stroke-width: 1;
      }

      .axis path,
      .axis line {
        fill: none;
        stroke: black;
        shape-rendering: crispEdges;
      }

      .axis text {
        font-family: sans-serif;
        font-size: 11px;
      }


    </style>
  </head>
  <body>

    <div id="chart"></div>

    <script src="js/d3.v3.js"></script>

    <script>

      var width = window.innerWidth,
          height = window.innerHeight,
          padding = 20;

      var svg = d3.select("#chart")
          .append("svg")
            .attr("width", width)
            .attr("height", height);


      var debug = {};
      d3.json("elevation-profile.json", function(err, elevation) {

        debug.elevation = elevation;

        // distance is in miles, height is in feet. need to convert.
        function milesToFeet(mi) {
          return 5280 * mi;
        }
        
        var maxDist = d3.max(elevation, function(d) { return milesToFeet(d.distance); }),
            maxHeight = d3.max(elevation, function(d) { return d.height; });
        var maxScale = Math.max(maxDist, maxHeight);  // so everything is in proportion

        // var clamp = d3.scale.linear().domain([0, maxScale]).range([padding, 500]); // proportional scale
        var x = d3.scale.linear().domain([0, maxDist]).range([padding, 800]);
        var y = d3.scale.linear().domain([0, maxHeight]).range([100, padding]);

        var line = d3.svg.line()
              .x(function(d) { return x(milesToFeet(d.distance)); })
              .y(function(d) { return y(d.height); });

        var g = svg.append("g")
          .attr("transform", "translate(" + padding + ", 0)");

        g.append("path")
          .attr("class", "elevation")
          .attr("d", line(elevation));

        var xAxis = d3.svg.axis()
            .scale(x)
            .orient("bottom")
            .ticks(5);  //Set rough # of ticks

        g.append("g")
            .attr("class", "axis")
            .attr("transform", "translate(0, 100)")
            .call(xAxis);

        // Define Y axis
        var yAxis = d3.svg.axis()
            .scale(y)
            .orient("left")
            .ticks(5);

        //Create Y axis
        g.append("g")
            .attr("class", "axis")
            .attr("transform", "translate(" + padding + ",0)")
            .call(yAxis);


      });

    </script>

  </body>
</html>